# AI-assistent
AI assistent for MEPHI students

## Описание  
Telegram бот с RAG ИИ Ассистентом для помощи студентам.
В качестве данных используются книжка первокурсника и посты за последний год из сообществ: mephi_official, osomephi, reactorclub, snomephi, vmephi.
Также предусмотрено изменение периода обхвата и списка сообщест через настройки парсинга.

## Файлы
1. Папка data - папка для подготовленных данных для модели  
1.1. import_db.py - Скрипт для поиска информации в ВБД  
1.2. faiss_db_vk - ВБД на основе постов из групп: osomephi, mephi_official  
1.3. faiss_db_vk_large - ВБД на основе постов из групп: osomephi, mephi_official, vmephi, reactorclub, snomephi  
1.4. faiss_db_policy - ВБД на основе методички
2. Папка parse - папка с парсером и неподготовленными данными  
2.1. testApi.py - тестовый скрипт для работы с API ВК  
2.2. parse-vk.py - скрипт для парсинга постов сообщества ВК  
2.3. cleaner.py - скрипт предобработки текста  
2.4. faiss-db-create.py - скипт для векторизации текста и создания векторной базы данных FAISS  
2.5. faiss_db_api.py - API на FastAPI для взаимодействия с векторной базой данных FAISS  
2.6. osomephi.csv - спарсенные данные из ОСО МИФИ  
2.7. reactorclub.csv - спарсенные данные из группы Реактор МИФИ  
2.8. snomephi.csv - спарсенные данные из СНО МИФИ  
2.9. vmephi.csv - спарсенные данные из группы МИФИ  
2.10. clean_data.csv - очищенные и подготовленные данные для создания ВБД  
3. Папка RAG - папка с RAG, скриптом для автоматического получения iam_token'a  
3.1  RAG_with_api.py - API на FastAPI для взаимодействия с RAG  
3.2  create_iam_token.py - скрипт для автоматического получения iam_token'a  
3.3  keys.json - файл с авторизованными ключами, которые необходимы для получения iam_token'a  
4. main.py - скрипт для запуска апи и бота
5. bot.py - скрипт телеграм бота
6. authdb.py - файл с функциями для работы с operators.db и logins.csv
7. operators.db - база данных с айдишниками авторизированных на данный момент пользователей (создаётся автоматически при первом запуске бота)
8. logins.csv - список логинов и паролей пользователей-операторов
9. operchatlogdb.py - файл для работы с operator_dialogs.db
10. operator_dialogs.db - база данных диалогов операторов с пользователями, также служит операторам в качестве inbox'а (создаётся автоматически при первом запуске бота)
11. survey_results.csv - файл с данными о пройденных опросах (создаётся автоматически при первом запуске бота)
12. requirements.txt - зависимости


Для работы телеграм бота создайте в корневой дирректории проекта файл "telegram_token.txt" с токеном для вашего бота без дополнительных символов. Для добавления новых пользователей-операторов отредактируйте файл "logins.csv", вводя начиная со второй строки логин и пароль через запятую без пробелов в новую строку для каждого нового пользователя.

Ссылка на векторные базы данных : https://disk.yandex.ru/d/2-F--Aw44QbGjg

## Получение токена пользователя
1. Создать приложение по ссылке https://vk.com/editapp?act=create
   Выбрать Платформу Standalone-приложение и нажать на кнопку "Перейти в сервис"  
   ![image](https://github.com/user-attachments/assets/eca8855b-4897-40fd-a7dc-6ac772c4967c)
2. Выбрать платформу Web
3. Базовый домен и доверенный URL можно указать любые
4. Завершить создание приложения
5. Запомнить id приложения
   ![image](https://github.com/user-attachments/assets/7fd0c800-bc82-40e5-86c2-455a1d3528c8)
6. подставить id приложения, полученный на предыдущем шаге, вместо параметра {ID} в ссылку
   https://oauth.vk.com/authorize?client_id={ID}&display=page&redirect_uri=https://oauth.vk.com/blank.html&scope=friends,notify,photos,wall,email,mail,groups,stats,offline&response_type=token&v=5.74
7. Вставить ссылку в адресную строку браузера и перейти по ней
8. После всех манипуляций в адресной строке браузера будет находиться токен пользователя
   
## Работа с данными  
1. Запустить скрипт parse-vk.py с аргументами: ИМЯ_ФАЙЛА_С_ССЫЛКАМИ_НА_СООБЩЕСТВА ДАТА_НАЧАЛА_ПАРСИНГА ДАТА_КОНЦА_ПАРСИНГА (подробнее "--help")  
```
python parse-vk.py Domains.txt --start_time="00:00:00#10.07.2025" --finish_time="12:34:56#19.07.2025"
```
2. Запустить скрипт cleaner.py для очистки данных  
Принимает аргументы: 

```
-r Перезапись файла
-l Удаление ссылок
--min_len минимальная длина текста в посте
-h подробнее про аргументы
```

3. Запустить скрипт faiss-db-create.py для создания ВБД  

___На будущее__ слить всё в один скрипт/батник, вынести все настройки в аргументы   
